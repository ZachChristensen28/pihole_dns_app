<dashboard version="2" theme="dark" hiddenElements="{&quot;hideEdit&quot;:false,&quot;hideOpenInSearch&quot;:false,&quot;hideExport&quot;:false}">
    <label>Pihole DNS Activity</label>
    <description></description>
    <definition>
        <![CDATA[{"visualizations":{"viz_chart_1":{"type":"splunk.pie","dataSources":{"primary":"ds_search_2"},"showProgressBar":true,"title":"Query Types","options":{"collapseThreshold":0.01},"context":{}},"viz_chart_2":{"type":"splunk.pie","dataSources":{"primary":"ds_search_3"},"eventHandlers":[{"type":"drilldown.linkToDashboard","options":{"app":"pihole_dns_app","dashboard":"pihole_dns_search","tokens":[{"token":"form.reply_code","value":"$click.value$"}],"newTab":true}}],"showProgressBar":true,"title":"Responses","options":{"collapseThreshold":0.01},"context":{}},"viz_table_1":{"type":"splunk.table","options":{"count":10,"dataOverlayMode":"none","drilldown":"cell","percentagesRow":false,"rowNumbers":false,"totalsRow":false,"wrap":true},"dataSources":{"primary":"ds_search_4"},"eventHandlers":[{"type":"drilldown.linkToDashboard","options":{"app":"pihole_dns_app","dashboard":"pihole_dns_search","tokens":[{"token":"form.query","value":"$row.Query$"}],"newTab":true}}],"title":"Top Queries"},"viz_table_2":{"type":"splunk.table","options":{"count":10,"drilldown":"cell"},"dataSources":{"primary":"ds_search_5"},"eventHandlers":[{"type":"drilldown.linkToDashboard","options":{"app":"pihole_dns_app","dashboard":"pihole_dns_search","tokens":[{"token":"form.query","value":"$click.value$"}],"newTab":true}}],"title":"Top Blocked Queries"},"viz_chart_3":{"type":"splunk.column","dataSources":{"primary":"ds_search_6"},"eventHandlers":[{"type":"drilldown.linkToDashboard","options":{"app":"pihole_dns_app","dashboard":"pihole_dns_search","tokens":[{"token":"form.src","value":"$click.value$"},{"token":"form.reply_code","value":"all_errors"}],"newTab":true}}],"showProgressBar":true,"title":"Client Errors","options":{"yAxisAbbreviation":"auto","y2AxisAbbreviation":"auto","showRoundedY2AxisLabels":false,"legendTruncation":"ellipsisMiddle","showY2MajorGridLines":true,"xAxisLabelRotation":0,"xAxisTitleVisibility":"show","yAxisTitleVisibility":"show","y2AxisTitleVisibility":"show","yAxisScale":"linear","showOverlayY2Axis":0,"y2AxisScale":"inherit","dataValuesDisplay":"off","stackMode":"auto","showSplitSeries":0,"showIndependentYRanges":0,"legendDisplay":"right","lineWidth":2},"context":{}}},"dataSources":{"ds_search_1":{"type":"ds.search","options":{"query":"| tstats count where `pihole_index` sourcetype=pihole by host","queryParameters":{"earliest":"$global_time_tok.earliest$","latest":"$global_time_tok.latest$"}}},"ds_search_2":{"type":"ds.search","options":{"query":"| tstats `pihole_summariesonly` prestats=t count from datamodel=Network_Resolution.DNS where sourcetype=pihole DNS.message_type=query host=\"$host_tok$\" by DNS.record_type\n| `drop_dm_object_name(DNS)`\n| rename record_type as \"Query Types\"\n| chart count by \"Query Types\"","queryParameters":{"earliest":"$global_time_tok.earliest$","latest":"$global_time_tok.latest$"}},"name":"pihole_query_types"},"ds_search_3":{"type":"ds.search","options":{"query":"| tstats `pihole_summariesonly` prestats=t count from datamodel=Network_Resolution.DNS where sourcetype=pihole DNS.message_type=response host=\"$host_tok$\" by DNS.reply_code\n| `drop_dm_object_name(DNS)`\n| rename reply_code as \"Responses\"\n| chart count by \"Responses\"","queryParameters":{"earliest":"$global_time_tok.earliest$","latest":"$global_time_tok.latest$"}},"name":"pihole_responses"},"ds_search_4":{"type":"ds.search","options":{"query":"| tstats `pihole_summariesonly` count from datamodel=Network_Resolution.DNS where sourcetype=pihole DNS.message_type=response DNS.reply_code!=\"Query Refused\" host=\"$host_tok$\" by DNS.query, DNS.reply_code\n| `drop_dm_object_name(DNS)`\n| rename query as Query\n| stats sum(count) as Count, sum(eval(if(reply_code!=\"No Error\", 'count', 0))) as Errors by Query\n| sort - Count","queryParameters":{"earliest":"$global_time_tok.earliest$","latest":"$global_time_tok.latest$"}},"name":"pihole_top_queries"},"ds_search_5":{"type":"ds.search","options":{"query":"| tstats `pihole_summariesonly` count as Count from datamodel=Network_Resolution.DNS where sourcetype=pihole DNS.message_type=response DNS.reply_code=\"Query Refused\" host=\"$host_tok$\" by DNS.query\n| `drop_dm_object_name(DNS)`\n| rename query as Query\n| sort - Count","queryParameters":{"earliest":"$global_time_tok.earliest$","latest":"$global_time_tok.latest$"}},"name":"pihole_top_blocked"},"ds_search_6":{"type":"ds.search","options":{"query":"| tstats `pihole_summariesonly` count from datamodel=Network_Resolution.DNS where sourcetype=pihole DNS.message_type=response DNS.reply_code!=\"No Error\" DNS.reply_code!=\"Query Refused\" host=\"$host_tok$\" by DNS.src\n| `drop_dm_object_name(DNS)`\n| rename src as \"Source IP\", count as \"# of Errors\"","queryParameters":{"earliest":"$global_time_tok.earliest$","latest":"$global_time_tok.latest$"}},"name":"pihole_errors"}},"defaults":{"dataSources":{"ds.search":{"options":{"queryParameters":{}}}}},"inputs":{"input_1":{"type":"input.timerange","title":"","options":{"token":"global_time_tok","defaultValue":"@d,now"}},"input_2":{"type":"input.dropdown","title":"Pi-hole Server","options":{"token":"host_tok","defaultValue":"*","items":[{"value":"*","label":"All"}]},"dataSources":{"primary":"ds_search_1"}}},"layout":{"type":"grid","options":{"submitButton":false,"height":750},"structure":[{"item":"viz_chart_1","type":"block","position":{"x":0,"y":0,"w":600,"h":250}},{"item":"viz_chart_2","type":"block","position":{"x":600,"y":0,"w":600,"h":250}},{"item":"viz_table_1","type":"block","position":{"x":0,"y":250,"w":600,"h":250}},{"item":"viz_table_2","type":"block","position":{"x":600,"y":250,"w":600,"h":250}},{"item":"viz_chart_3","type":"block","position":{"x":0,"y":500,"w":1200,"h":250}}],"globalInputs":["input_1","input_2"]},"description":"","title":"Pihole DNS Activity Copy"}]]>
    </definition>
    <assets>
        <![CDATA[{}]]>
    </assets>
</dashboard>
